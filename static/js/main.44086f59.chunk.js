(this.webpackJsonpbarquest=this.webpackJsonpbarquest||[]).push([[1],{70:function(e,t,n){var r={"./ion-action-sheet.entry.js":[97,5],"./ion-alert.entry.js":[98,6],"./ion-app_8.entry.js":[99,7],"./ion-avatar_3.entry.js":[100,17],"./ion-back-button.entry.js":[101,18],"./ion-backdrop.entry.js":[102,43],"./ion-button_2.entry.js":[103,19],"./ion-card_5.entry.js":[104,20],"./ion-checkbox.entry.js":[105,21],"./ion-chip.entry.js":[106,22],"./ion-col_3.entry.js":[107,44],"./ion-datetime_3.entry.js":[108,10],"./ion-fab_3.entry.js":[109,23],"./ion-img.entry.js":[110,45],"./ion-infinite-scroll_2.entry.js":[111,46],"./ion-input.entry.js":[112,24],"./ion-item-option_3.entry.js":[113,25],"./ion-item_8.entry.js":[114,26],"./ion-loading.entry.js":[115,27],"./ion-menu_3.entry.js":[116,28],"./ion-modal.entry.js":[117,8],"./ion-nav_2.entry.js":[118,14],"./ion-popover.entry.js":[119,9],"./ion-progress-bar.entry.js":[120,29],"./ion-radio_2.entry.js":[121,30],"./ion-range.entry.js":[122,31],"./ion-refresher_2.entry.js":[123,11],"./ion-reorder_2.entry.js":[124,16],"./ion-ripple-effect.entry.js":[125,47],"./ion-route_4.entry.js":[126,32],"./ion-searchbar.entry.js":[127,33],"./ion-segment_2.entry.js":[128,34],"./ion-select_3.entry.js":[129,35],"./ion-slide_2.entry.js":[130,48],"./ion-spinner.entry.js":[131,13],"./ion-split-pane.entry.js":[132,49],"./ion-tab-bar_2.entry.js":[133,36],"./ion-tab_2.entry.js":[134,15],"./ion-text.entry.js":[135,37],"./ion-textarea.entry.js":[136,38],"./ion-toast.entry.js":[137,39],"./ion-toggle.entry.js":[138,12],"./ion-virtual-scroll.entry.js":[139,50]};function c(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(r)},c.id=70,e.exports=c},72:function(e,t,n){var r={"./ion-icon.entry.js":[140,57]};function c(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(r)},c.id=72,e.exports=c},80:function(e,t,n){},83:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(31),i=n.n(a),s=n(4),o=n(59),u=n(23),j=n(22),l=(n(80),n(1)),d=[{title:"Inbox",url:"/",iosIcon:j.h,mdIcon:j.i}],b=function(){var e=Object(u.d)();return Object(l.jsx)(s.n,{contentId:"main",type:"overlay",children:Object(l.jsx)(s.e,{children:Object(l.jsxs)(s.l,{id:"inbox-list",children:[Object(l.jsx)(s.m,{children:"Inbox"}),Object(l.jsx)(s.q,{children:"hi@ionicframework.com"}),d.map((function(t,n){return Object(l.jsx)(s.p,{autoHide:!1,children:Object(l.jsxs)(s.j,{className:e.pathname===t.url?"selected":"",routerLink:t.url,routerDirection:"none",lines:"none",detail:!1,children:[Object(l.jsx)(s.h,{slot:"start",ios:t.iosIcon,md:t.mdIcon}),Object(l.jsx)(s.k,{children:t.title})]})},n)}))]})})})},x=n(33),O=n(40),h={version:1,id:"",name:"Player",xp:0,currentActivity:void 0,activityLog:[],quests:{open:[],active:void 0,completed:[]}},f=Object(O.c)({name:"player",initialState:h,reducers:{newGameStarted:function(e,t){e.id=t.payload.id,e.name=t.payload.playerName},gameLoaded:function(e,t){return t.payload},questStarted:function(e,t){e.quests.active&&(e.quests.completed=[e.quests.active].concat(Object(x.a)(e.quests.completed))),e.quests.active=t.payload},activeQuestChanged:function(e,t){e.quests.active=t.payload},actionStarted:function(e,t){e.currentActivity=t.payload},activityFinished:function(e,t){var n=t.payload;e.xp+=n.xpReward;var r=[n].concat(Object(x.a)(e.activityLog));e.activityLog=r.slice(0,Math.min(r.length,100))}}}),p=f.actions,v=p.newGameStarted,y=p.gameLoaded,m=p.actionStarted,g=p.questStarted,k=p.activeQuestChanged,w=p.activityFinished,_=Object(O.b)("game/startGame"),S=function(e){return e.player.xp},I=function(e){return e.player.name},C=function(e){return e.player.currentActivity},N=function(e){return e.player.activityLog},q=function(e){return e.player.quests.active},A=function(e){return e.player.quests.completed},F=function(e){if(e.player.quests.active&&e.player.quests.active.openActivities.length>0)return e.player.quests.active.openActivities[0]},L=function(e){return e.player},M=f.reducer,D=n(39),P=D.c,E=(n(83),function(e){var t=e.value,n=e.animated,c=e.animationDurationInMS,a=e.label,i=e.color,o=null!==i&&void 0!==i?i:"green",u=null!==a&&void 0!==a?a:Math.round(100*t)+"%",j=Object(r.useRef)(null);return Object(r.useEffect)((function(){j&&n&&(j.current.animation.stop(),j.current.animation.play())}),[n,c,j]),Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("div",{className:"progressbar-outer",children:[Object(l.jsx)(s.a,{duration:c,iterations:1/0,fromTo:{property:"width",fromValue:"0",toValue:"100%"},ref:j,children:Object(l.jsx)("div",{className:"progressbar-inner",style:{width:"".concat(100*t,"%"),backgroundColor:o}})}),Object(l.jsx)("div",{className:"progressbar-percentage",children:Object(l.jsx)("span",{children:u})})]})})}),G=function(){var e=P(C);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("span",{children:e?e.name:"Idle"}),Object(l.jsx)(E,{label:e?e.name:"",value:0,animated:!0,animationDurationInMS:e?1e3*e.duration:0})]})};function R(e){return e<=0?0:100*(e-1)}var z=function(){var e=P(S),t=function(e){return e<=0?1:1+Math.floor(e/100)}(e),n=R(t+1),r=function(e,t){var n=R(e);return(t-n)/(R(e+1)-n)}(t,e),c="".concat(e," / ").concat(n," XP");return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("div",{children:["Level ",t," ",Object(l.jsx)(E,{value:r,label:c,color:"blue"})]})})},B=function(){var e=P(N);return Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{children:"Recent activities:"}),e.length>0?Object(l.jsx)("ul",{children:e.map((function(e){return Object(l.jsxs)("li",{children:[e.name," (+",e.xpReward," XP)"]},e.id)}))}):Object(l.jsx)("div",{children:"Nothing"})]})},T=function(){var e=P(q),t=P(A);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{children:"Active Quest:"}),Object(l.jsx)("div",{children:e?e.title:"None"}),Object(l.jsx)("ul",{children:e?e.openActivities.map((function(e){return Object(l.jsx)("li",{children:e.name},e.id)})):null}),Object(l.jsx)("div",{children:"Open Quests:"}),Object(l.jsx)("div",{children:"The story so far:"}),Object(l.jsx)("ul",{children:t.map((function(e){return Object(l.jsx)("li",{children:e.title},e.id)}))})]})},J=function(){var e=Object(u.e)().gameId,t=P(I),n=Object(D.b)();return Object(r.useEffect)((function(){n(_(e))}),[e]),Object(l.jsxs)(s.r,{children:[Object(l.jsx)(s.g,{children:Object(l.jsxs)(s.z,{children:[Object(l.jsx)(s.c,{slot:"start",children:Object(l.jsx)(s.o,{})}),Object(l.jsx)(s.y,{children:t})]})}),Object(l.jsxs)(s.e,{fullscreen:!0,children:[Object(l.jsx)(s.g,{collapse:"condense",children:Object(l.jsx)(s.z,{children:Object(l.jsx)(s.y,{size:"large",children:t})})}),Object(l.jsx)(s.f,{children:Object(l.jsxs)(s.u,{children:[Object(l.jsxs)(s.d,{size:"12","size-lg":"6",children:[Object(l.jsx)(G,{}),Object(l.jsx)(B,{})]}),Object(l.jsxs)(s.d,{size:"12","size-lg":"6",children:[Object(l.jsx)(z,{}),Object(l.jsx)(T,{})]})]})})]})]})},Q=n(32),H=function(){var e=Object(r.useState)(),t=Object(Q.a)(e,2),n=t[0],c=t[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(s.g,{children:Object(l.jsx)(s.y,{children:"Create new hero"})}),Object(l.jsxs)(s.l,{children:[Object(l.jsx)(s.j,{children:Object(l.jsx)(s.i,{value:n,placeholder:"Player Name",onIonChange:function(e){return c(e.detail.value)}})}),Object(l.jsxs)(s.j,{children:[Object(l.jsx)(s.k,{children:"Character class"}),Object(l.jsx)(s.v,{children:Object(l.jsx)(s.w,{value:"carpenter",children:"Carpenter"})})]})]})]})},U=n(5),W=n.n(U),V=n(18),X=n(44),K=new X.b({driverOrder:[X.a.LocalStorage,X.a.IndexedDB]}),Z=function(){var e=Object(V.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.create();case 2:return e.abrupt("return",K);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$={listSaveGames:function(){var e=Object(V.a)(W.a.mark((function e(){var t,n,r,c,a,i,s,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:return t=e.sent,e.next=5,t.keys();case 5:n=e.sent,r=n.filter((function(e){return e.startsWith("game_")})),c=[],e.t0=W.a.keys(r);case 9:if((e.t1=e.t0()).done){e.next=19;break}return a=e.t1.value,i=r[a],e.next=14,t.get(i);case 14:s=e.sent,o=JSON.parse(s),c.push({id:o.id,playerName:o.name}),e.next=9;break;case 19:return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},Y=function(){var e=Object(r.useState)([]),t=Object(Q.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){$.listSaveGames().then(c)}),[]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(s.g,{children:Object(l.jsx)(s.y,{children:"Continue adventure"})}),Object(l.jsx)(s.l,{children:n.map((function(e){return Object(l.jsx)(s.j,{href:"/game/".concat(e.id),children:Object(l.jsx)(s.k,{children:e.playerName})},e.id)}))})]})},ee=function(){return Object(l.jsxs)(s.r,{children:[Object(l.jsx)(s.g,{children:Object(l.jsx)(s.z,{children:Object(l.jsx)(s.y,{children:"Welcome to BarQuest"})})}),Object(l.jsxs)(s.e,{children:[Object(l.jsx)(H,{}),Object(l.jsx)(Y,{})]})]})},te=n(63),ne=n(49),re=n(142),ce=n(9),ae=function(e,t,n){return{id:Object(re.a)(),name:e,duration:t,xpReward:n}};function ie(e){return e[Math.floor(Math.random()*e.length)]}var se={slayMonster:function(){var e=ie(["Slaying","Killing","Fighting","Battling","Engaging"]),t=ie(["Orc","Daemon","Imp","Rat","Goblin","Zombie","Mutant","Ghost","Dark Spirit","Skeleton","Evil Presence","Grasshopper","Ant","Spider"]),n=ie([2,3,4,5,7]),r=n;return ae("".concat(e," ").concat(t),r,n)},roamArea:function(){return ae(ie(["Roaming area","Searching areal","Investigate surroundings","Tracking footsteps","Following trails"]),5,1)},loot:function(){var e=ie(["Looting","Plundering","Pillaging","Robbing","Ransacking"]),t=ie(["Corpse","Body","Chest","Trove","Hideout","House","Shack","Cave","Den","Lair","Crate","Case","Hutch","Box","Sack"]);return ae("".concat(e," ").concat(t),2,1)}},oe=function(){var e=Object.keys(se),t=e[Math.floor(e.length*Math.random())];return se[t]()},ue=function(){return{title:"Prologue",id:"prologue",openActivities:[oe(),oe(),oe()]}},je=function(){return{title:ie(["Get me the dollars","Save the day","Deliver this letter"]),id:Object(re.a)(),openActivities:[oe(),oe(),oe()]}},le=W.a.mark(ve),de=W.a.mark(ye),be=W.a.mark(me),xe=W.a.mark(ge),Oe=W.a.mark(ke),he=W.a.mark(we),fe=W.a.mark(_e),pe=W.a.mark(Se);function ve(e){var t,n;return W.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(ce.b)(Z);case 3:return n=r.sent,r.next=6,Object(ce.a)(n,n.keys,[]);case 6:if(!r.sent.includes("game_".concat(t))){r.next=12;break}return r.next=10,Object(ce.b)(ke,t);case 10:r.next=14;break;case 12:return r.next=14,Object(ce.b)(ye,t);case 14:return r.next=16,Object(ce.b)(_e);case 16:case"end":return r.stop()}}),le)}function ye(e){var t;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ce.b)(ue);case 2:return t=n.sent,n.next=5,Object(ce.e)(g(t));case 5:return n.next=7,Object(ce.b)(we);case 7:return n.next=9,Object(ce.e)(v({id:e,playerName:"foo"}));case 9:case"end":return n.stop()}}),de)}function me(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ce.h)(_.type,ve);case 2:case"end":return e.stop()}}),be)}function ge(){var e,t,n;return W.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(ce.f)(L);case 2:return e=r.sent,r.next=5,Object(ce.b)(Z);case 5:return t=r.sent,r.next=8,Object(ce.b)(JSON.stringify,e);case 8:return n=r.sent,r.next=11,Object(ce.a)(t,t.set,["game_".concat(e.id),n]);case 11:case"end":return r.stop()}}),xe)}function ke(e){var t,n,r;return W.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(ce.b)(Z);case 2:return t=c.sent,c.next=5,Object(ce.a)(t,t.get,["game_".concat(e)]);case 5:return n=c.sent,c.next=8,Object(ce.b)(JSON.parse,n);case 8:return void 0===(r=c.sent).version&&(r.version=1,r.id=Object(re.a)()),c.next=12,Object(ce.e)(y(r));case 12:case"end":return c.stop()}}),Oe)}function we(){var e,t,n;return W.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(ce.b)(Math.random);case 2:return e=r.sent,t=e>.1,r.next=6,Object(ce.f)(F);case 6:if((n=r.sent)&&!t){r.next=11;break}return r.next=10,Object(ce.b)(oe);case 10:n=r.sent;case 11:return r.next=13,Object(ce.e)(m(n));case 13:case"end":return r.stop()}}),he)}function _e(){var e,t;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ce.d)(Se);case 2:e=n.sent,Object(re.a)();case 4:return n.next=7,Object(ce.f)(C);case 7:return(t=n.sent)||console.error("Game loop called without a currentActivity1"),n.next=11,Object(ce.c)(1e3*t.duration);case 11:return n.next=13,Object(ce.e)(w(t));case 13:return n.next=15,Object(ce.b)(we);case 15:return n.next=17,Object(ce.b)(ge);case 17:n.next=4;break;case 19:e.cancel();case 20:case"end":return n.stop()}}),fe)}function Se(){var e,t;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=function(t){var n,r,c,a,i;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ce.f)(q);case 2:if((n=e.sent)&&!(n.openActivities.length<=0)){e.next=10;break}return e.next=6,Object(ce.b)(je);case 6:return r=e.sent,e.next=9,Object(ce.e)(g(r));case 9:return e.abrupt("return");case 10:if(t.payload.id!==n.openActivities[0].id){e.next=25;break}if((c=Object(x.a)(n.openActivities)).shift(),!(c.length>0)){e.next=20;break}return a=Object(ne.a)(Object(ne.a)({},n),{},{openActivities:c}),e.next=18,Object(ce.e)(k(a));case 18:e.next=25;break;case 20:return e.next=22,Object(ce.b)(je);case 22:return i=e.sent,e.next=25,Object(ce.e)(g(i));case 25:case"end":return e.stop()}}),e)},e=W.a.mark(t),n.next=4,Object(ce.g)(w.type,t);case 4:case"end":return n.stop()}}),pe)}var Ie=Object(te.a)(),Ce=Object(O.a)({reducer:{player:M},middleware:[Ie]});Ie.run(me);n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94);var Ne=function(){return Object(l.jsx)(D.a,{store:Ce,children:Object(l.jsx)(s.b,{children:Object(l.jsx)(o.a,{children:Object(l.jsxs)(s.x,{contentId:"main",children:[Object(l.jsx)(b,{}),Object(l.jsxs)(s.t,{id:"main",children:[Object(l.jsx)(u.a,{path:"/",exact:!0,children:Object(l.jsx)(ee,{})}),Object(l.jsx)(u.a,{path:"/game/:gameId",exact:!0,children:Object(l.jsx)(J,{})})]})]})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var qe=function(e){e&&e instanceof Function&&n.e(58).then(n.bind(null,158)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};i.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(Ne,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),qe()}},[[95,3,4]]]);
//# sourceMappingURL=main.44086f59.chunk.js.map